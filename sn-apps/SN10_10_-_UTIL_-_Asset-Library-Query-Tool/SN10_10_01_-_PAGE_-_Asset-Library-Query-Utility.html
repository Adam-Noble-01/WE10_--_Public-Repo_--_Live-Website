<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Add Application Version Meta Tag -->
    <meta name="application-version" content="1.0.0"> <!-- ← CONFIG | Set Application Version Here -->
    <title>Noble Architecture - Asset Library Query Tool</title>
    
    <!--  - - - - - - - - - - - - - - - - - -  FAVICON CONFIGURATION  - - - - - - - - - - - - - - - - - - -->
    <!-- Primary SVG Favicon (Best for modern browsers) -->
    <link rel="icon" type="image/svg+xml" href="/assets/AD05_-_LIBR_-_Common_-_Icons-and-favicons/AD05_01_-_NA_Favicon_-_SVG-h50mm.svg">
    <!-- PNG Fallbacks for various resolutions -->
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/AD05_-_LIBR_-_Common_-_Icons-and-favicons/AD05_04_-_NA_Favicon_-_PNG-h512px.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/AD05_-_LIBR_-_Common_-_Icons-and-favicons/AD05_05_-_NA_Favicon_-_PNG-h192px.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/AD05_-_LIBR_-_Common_-_Icons-and-favicons/AD05_06_-_NA_Favicon_-_PNG-h32px.png">
    <!-- ICO Fallback for legacy browsers -->
    <link rel="icon" type="image/x-icon" href="/assets/AD05_-_LIBR_-_Common_-_Icons-and-favicons/AD05_07_-_NA_Favicon_-_ICO-h32px.ico">
    <!--  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    
    <!--  - - - - - - - - - - - - - - - - - -  STYLESHEET CONFIGURATION  - - - - - - - - - - - - - - - - - - -->
    <!-- Main Noble Architecture Stylesheet -->
    <link rel="stylesheet" href="/assets/AD02_-_STYL_-_Common_-_StyleSheets/AD02_10_-_STYL_-_Core-Default-Stylesheet_-_Noble-Architecture.css">
    
    <!-- Utility App Stylesheet -->
    <link rel="stylesheet" href="/assets/AD02_-_STYL_-_Common_-_StyleSheets/AD02_30_-_STYL_-_Core-Default-Web-Utility-App-Stylesheet.css">
    <!--  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

    <!-- 
    ==============================================================================================
    REMOVED EMBEDDED STYLES - NOW USING SHARED UTILITY APP STYLESHEET
    ==============================================================================================
    -->

</head>
<body>
    <div class="PAGE__container">
        <header class="HEAD__container">
            <nav class="HEAD__nav">
                <span class="HEAD__title">Asset Library Query Tool</span>
                <span class="HEAD__version-note">v1.0.0</span>
            </nav>
        </header>

        <div class="FULL__page-app-container">
            <div class="MAIN__container">
                <!-- Query Section -->
                <div class="QURY__block">
                    <h2 class="QURY__heading">Asset Query</h2>
                    
                    <div class="FORM__group">
                        <label for="library-type" class="FORM__label">Select Library Type:</label>
                        <select id="library-type" class="FORM__select">
                            <option value="">-- Select Library Type --</option>
                            <option value="Common_Web_Assets_Libraries">Common Web Assets Libraries</option>
                            <option value="Core-Source-Code-Library">Core Source Code Library</option>
                            <option value="Core_Documentation_Files_Library">Core Documentation Files Library</option>
                        </select>
                    </div>
                    
                    <div class="FORM__group">
                        <label for="asset-type" class="FORM__label">Filter by Asset Type (optional):</label>
                        <select id="asset-type" class="FORM__select">
                            <option value="">-- All Asset Types --</option>
                            <option value="font">Font</option>
                            <option value="icon">Icon</option>
                            <option value="documentation">Documentation</option>
                            <option value="source code">Source Code</option>
                        </select>
                    </div>
                    
                    <div class="FORM__group">
                        <label for="search-term" class="FORM__label">Search by Name or Description (optional):</label>
                        <input type="text" id="search-term" class="FORM__input" placeholder="Enter search term...">
                    </div>
                    
                    <div class="BTTN__container">
                        <button id="query-btn" class="BTTN__standard BTTN__query">Query Assets</button>
                        <button id="reset-btn" class="BTTN__cancel">Reset Tool</button>
                    </div>
                </div>
                
                <div id="error-container" class="ERRR__container" style="display: none;"></div>
                
                <!-- Results Section -->
                <div class="RSLT__block">
                    <div class="RSLT__header">
                        <h2 class="RSLT__heading">Results</h2>
                        <div class="RSLT__count" id="results-count"></div>
                    </div>
                    
                    <div id="loading" class="RSLT__loading" style="display: none;">Loading asset data...</div>
                    
                    <div id="no-results" class="RSLT__no-results" style="display: none;">
                        No results found. Try adjusting your search criteria.
                    </div>
                    
                    <div class="BTTN__container" style="margin-bottom: 00.75rem; display: none;" id="export-container">
                        <button id="export-btn" class="BTTN__standard BTTN__export">Export URLs</button>
                    </div>
                    
                    <ul id="url-list" class="URL__list"></ul>
                </div>
            </div>
        </div>

        <footer class="FOOT__container">
            &copy; © 2025 Noble Architecture | All Rights Reserved
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const libraryTypeSelect = document.getElementById('library-type');
            const assetTypeSelect = document.getElementById('asset-type');
            const searchTermInput = document.getElementById('search-term');
            const queryBtn = document.getElementById('query-btn');
            const resetBtn = document.getElementById('reset-btn');
            const urlList = document.getElementById('url-list');
            const resultsCount = document.getElementById('results-count');
            const noResults = document.getElementById('no-results');
            const loading = document.getElementById('loading');
            const errorContainer = document.getElementById('error-container');
            const exportBtn = document.getElementById('export-btn');
            const exportContainer = document.getElementById('export-container');
            
            // Asset Library Data
            let assetLibraryData = null;
            

            // CONFIGURATION | Fetch the asset library data
            // -------------------------------------------------------------------------------------
            async function fetchAssetLibraryData() {
                try {
                    loading.style.display = 'block';
                    errorContainer.style.display = 'none';
                    
                    const response = await fetch
                    ('../../assets/AD01_-_DATA_-_Common_-_Global-Data-Library/AD01_10_-_DATA_-_Common_-_Core-Web-Asset-Library.json');
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    
                    assetLibraryData = await response.json();
                    return assetLibraryData;
                } catch (error) {
                    console.error('Error fetching asset library data:', error);
                    errorContainer.textContent = `Error loading asset data: ${error.message}`;
                    errorContainer.style.display = 'block';
                    return null;
                } finally {
                    loading.style.display = 'none';
                }
            }
            
            // Reset the tool
            function resetTool() {
                // Clear form fields
                libraryTypeSelect.value = '';
                assetTypeSelect.value = '';
                searchTermInput.value = '';
                
                // Clear results
                urlList.innerHTML = '';
                resultsCount.textContent = '';
                
                // Hide result elements
                noResults.style.display = 'none';
                exportContainer.style.display = 'none';
                
                // Clear any errors
                errorContainer.style.display = 'none';
            }
            
            // Query assets based on selected criteria
            function queryAssets() {
                if (!assetLibraryData) {
                    errorContainer.textContent = 'Asset library data not loaded. Please try again.';
                    errorContainer.style.display = 'block';
                    return;
                }
                
                const libraryType = libraryTypeSelect.value;
                const assetType = assetTypeSelect.value.toLowerCase();
                const searchTerm = searchTermInput.value.toLowerCase();
                
                if (!libraryType) {
                    errorContainer.textContent = 'Please select a library type.';
                    errorContainer.style.display = 'block';
                    return;
                }
                
                errorContainer.style.display = 'none';
                let urls = [];
                
                // Get the selected library
                const library = assetLibraryData[libraryType];
                
                if (!library) {
                    errorContainer.textContent = 'Selected library not found.';
                    errorContainer.style.display = 'block';
                    return;
                }
                
                // Process different library structures
                if (libraryType === 'Common_Web_Assets_Libraries') {
                    // Process each sub-library in Common Web Assets
                    for (const subLibraryKey in library) {
                        const subLibrary = library[subLibraryKey];
                        
                        // Check if the sub-library has assets
                        if (subLibrary.assets) {
                            for (const assetKey in subLibrary.assets) {
                                const asset = subLibrary.assets[assetKey];
                                if (matchesCriteria(asset, assetType, searchTerm)) {
                                    urls.push({
                                        url: asset["asset-web-url"] || '',
                                        name: asset["asset-name"] || assetKey
                                    });
                                }
                            }
                        } else {
                            // Handle case where assets are direct properties of the sub-library
                            for (const assetKey in subLibrary) {
                                if (assetKey !== 'library-dir-path' && 
                                    assetKey !== 'library-web-url' && 
                                    assetKey !== 'library-file-name' && 
                                    assetKey !== 'library-id-code' && 
                                    assetKey !== 'library-type' && 
                                    assetKey !== 'library-category' && 
                                    assetKey !== 'library-description' && 
                                    assetKey !== 'library-usage' && 
                                    assetKey !== 'library-added-by' && 
                                    assetKey !== 'library-last-updated' && 
                                    assetKey !== 'library-active-status' && 
                                    assetKey !== 'assets') {
                                    
                                    const asset = subLibrary[assetKey];
                                    if (typeof asset === 'object' && matchesCriteria(asset, assetType, searchTerm)) {
                                        urls.push({
                                            url: asset["asset-web-url"] || '',
                                            name: asset["asset-name"] || assetKey
                                        });
                                    }
                                }
                            }
                        }
                    }
                } else {
                    // Process Core Source Code Library and Core Documentation Files Library
                    if (library.assets) {
                        for (const assetKey in library.assets) {
                            const asset = library.assets[assetKey];
                            if (matchesCriteria(asset, assetType, searchTerm)) {
                                urls.push({
                                    url: asset["asset-web-url"] || '',
                                    name: asset["asset-name"] || assetKey
                                });
                            }
                        }
                    }
                }
                
                // Display results
                displayUrls(urls);
            }
            
            // Check if an asset matches the search criteria
            function matchesCriteria(asset, assetType, searchTerm) {
                if (!asset || typeof asset !== 'object') return false;
                
                // Check asset type filter
                if (assetType && asset["asset-type"] && asset["asset-type"].toLowerCase() !== assetType) {
                    return false;
                }
                
                // Check search term
                if (searchTerm) {
                    const name = (asset["asset-name"] || '').toLowerCase();
                    const description = (asset["asset-description"] || '').toLowerCase();
                    const category = (asset["asset-category"] || '').toLowerCase();
                    
                    if (!name.includes(searchTerm) && 
                        !description.includes(searchTerm) && 
                        !category.includes(searchTerm)) {
                        return false;
                    }
                }
                
                return true;
            }
            
            // Display the URLs
            function displayUrls(urls) {
                urlList.innerHTML = '';
                
                if (urls.length === 0) {
                    noResults.style.display = 'block';
                    exportContainer.style.display = 'none';
                    urlList.style.display = 'none';
                    return;
                }
                
                noResults.style.display = 'none';
                urlList.style.display = 'block';
                resultsCount.textContent = `${urls.length} URL(s) found`;
                exportContainer.style.display = 'flex';
                
                // Sort URLs alphabetically
                urls.sort((a, b) => a.url.localeCompare(b.url));
                
                urls.forEach(item => {
                    if (!item.url) return;
                    
                    const li = document.createElement('li');
                    li.className = 'URL__item';
                    
                    const link = document.createElement('a');
                    link.href = item.url;
                    link.target = '_blank';
                    link.className = 'URL__link';
                    link.textContent = item.url;
                    link.title = item.name || '';
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'URL__copy-btn';
                    copyBtn.textContent = 'Copy To Clipboard';
                    copyBtn.addEventListener('click', function() {
                        navigator.clipboard.writeText(item.url)
                            .then(() => {
                                copyBtn.textContent = 'Copied!';
                                setTimeout(() => {
                                    copyBtn.textContent = 'Copy To Clipboard';
                                }, 2000);
                            })
                            .catch(err => {
                                console.error('Failed to copy: ', err);
                            });
                    });
                    
                    li.appendChild(link);
                    li.appendChild(copyBtn);
                    
                    urlList.appendChild(li);
                });
            }
            
            // Export URLs to clipboard
            function exportUrls() {
                const urls = Array.from(urlList.querySelectorAll('.URL__link'))
                    .map(a => a.href);
                
                if (urls.length === 0) {
                    return;
                }
                
                const urlsText = urls.join('\n');
                
                navigator.clipboard.writeText(urlsText)
                    .then(() => {
                        exportBtn.textContent = 'URLs Copied!';
                        setTimeout(() => {
                            exportBtn.textContent = 'Export URLs';
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Failed to copy URLs: ', err);
                    });
            }
            
            // Event Listeners
            queryBtn.addEventListener('click', queryAssets);
            resetBtn.addEventListener('click', resetTool);
            exportBtn.addEventListener('click', exportUrls);
            
            // Initialize by loading the asset library data
            fetchAssetLibraryData();
        });
    </script>
</body>
</html> 